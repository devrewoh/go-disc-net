package network

import (
	"strings"
)

// MACVendorDatabase contains OUI (Organizationally Unique Identifier) mappings
// This is a subset - in production you'd load from IEEE OUI database
var macVendorDB = map[string]string{
	// Apple
	"00:03:93": "Apple",
	"00:05:02": "Apple",
	"00:0A:95": "Apple",
	"00:0D:93": "Apple",
	"00:16:CB": "Apple",
	"00:17:F2": "Apple",
	"00:19:E3": "Apple",
	"00:1B:63": "Apple",
	"00:1E:C2": "Apple",
	"00:21:E9": "Apple",
	"00:23:12": "Apple",
	"00:23:DF": "Apple",
	"00:25:00": "Apple",
	"00:25:4B": "Apple",
	"00:25:BC": "Apple",
	"00:26:08": "Apple",
	"00:26:4A": "Apple",
	"00:26:B0": "Apple",
	"00:26:BB": "Apple",
	"04:0C:CE": "Apple",
	"04:15:52": "Apple",
	"04:1E:64": "Apple",
	"04:26:65": "Apple",
	"04:48:9A": "Apple",
	"04:4B:ED": "Apple",
	"04:52:F3": "Apple",
	"04:54:53": "Apple",
	"04:69:F8": "Apple",
	"04:DB:56": "Apple",
	"04:E5:36": "Apple",
	"04:F1:3E": "Apple",
	"04:F7:E4": "Apple",
	"08:00:07": "Apple",
	"08:74:02": "Apple",
	"0C:3E:9F": "Apple",
	"0C:74:C2": "Apple",
	"10:93:E9": "Apple",
	"10:9A:DD": "Apple",
	"14:10:9F": "Apple",
	"14:7D:DA": "Apple",
	"14:BD:61": "Apple",
	"18:34:51": "Apple",
	"18:AF:8F": "Apple",
	"1C:1A:C0": "Apple",
	"1C:AB:A7": "Apple",
	"20:3C:AE": "Apple",
	"20:A2:E4": "Apple",
	"24:A0:74": "Apple",
	"24:AB:81": "Apple",
	"28:37:37": "Apple",
	"28:E0:2C": "Apple",
	"2C:1F:23": "Apple",
	"2C:36:F8": "Apple",
	"2C:B4:3A": "Apple",
	"30:10:B3": "Apple",
	"30:74:96": "Apple",
	"34:15:9E": "Apple",
	"34:51:C9": "Apple",
	"34:AB:37": "Apple",
	"38:00:25": "Apple",
	"38:C9:86": "Apple",
	"3C:15:C2": "Apple",
	"40:B3:95": "Apple",
	"40:CB:C0": "Apple",
	"44:00:10": "Apple",
	"44:4C:A8": "Apple",
	"48:43:7C": "Apple",
	"4C:8D:79": "Apple",
	"50:EA:D6": "Apple",
	"54:26:96": "Apple",
	"54:72:4F": "Apple",
	"58:55:CA": "Apple",
	"5C:59:48": "Apple",
	"5C:95:AE": "Apple",
	"60:03:08": "Apple",
	"60:33:4B": "Apple",
	"60:F4:45": "Apple",
	"64:20:9F": "Apple",
	"64:B9:E8": "Apple",
	"68:96:7B": "Apple",
	"6C:72:20": "Apple",
	"70:11:24": "Apple",
	"70:56:81": "Apple",
	"74:E2:E6": "Apple",
	"78:31:C1": "Apple",
	"78:4F:43": "Apple",
	"7C:6D:62": "Apple",
	"7C:C3:A1": "Apple",
	"80:BE:05": "Apple",
	"84:38:35": "Apple",
	"84:85:06": "Apple",
	"88:1F:A1": "Apple",
	"8C:58:77": "Apple",
	"90:84:0D": "Apple",
	"94:F6:A3": "Apple",
	"98:F0:AB": "Apple",
	"9C:84:BF": "Apple",
	"A0:99:9B": "Apple",
	"A4:83:E7": "Apple",
	"A8:20:66": "Apple",
	"A8:86:DD": "Apple",
	"AC:87:A3": "Apple",
	"B0:65:BD": "Apple",
	"B4:F0:AB": "Apple",
	"B8:09:8A": "Apple",
	"B8:8D:12": "Apple",
	"BC:52:B7": "Apple",
	"C0:9F:42": "Apple",
	"C4:B3:01": "Apple",
	"C8:BC:C8": "Apple",
	"C8:E0:EB": "Apple",
	"CC:20:E8": "Apple",
	"D0:03:4B": "Apple",
	"D4:9A:20": "Apple",
	"D8:30:62": "Apple",
	"D8:A2:5E": "Apple",
	"DC:2B:2A": "Apple",
	"E0:AC:CB": "Apple",
	"E4:E4:AB": "Apple",
	"E8:80:2E": "Apple",
	"F0:DB:E2": "Apple",
	"F4:F1:5A": "Apple",
	"F8:16:54": "Apple",
	"FC:25:3F": "Apple",

	// Gigabyte/AORUS
	"00:1B:FC": "Gigabyte Technology",
	"00:24:21": "Gigabyte Technology",
	"1C:1B:0D": "Gigabyte Technology",
	"E0:D5:5E": "Gigabyte Technology",

	// Microsoft
	"00:12:5A": "Microsoft",
	"00:15:5D": "Microsoft",
	"00:17:FA": "Microsoft",
	"00:1D:D8": "Microsoft",
	"00:50:F2": "Microsoft",
	"18:DB:F2": "Microsoft",
	"28:18:78": "Microsoft",
	"7C:1E:52": "Microsoft",
	"AC:22:0B": "Microsoft",

	// Samsung
	"00:12:FB": "Samsung",
	"00:13:77": "Samsung",
	"00:15:99": "Samsung",
	"00:16:32": "Samsung",
	"00:17:C4": "Samsung",
	"00:1A:8A": "Samsung",
	"00:1E:7D": "Samsung",
	"00:21:19": "Samsung",
	"00:23:39": "Samsung",
	"00:26:37": "Samsung",
	"04:18:D6": "Samsung",
	"08:37:3D": "Samsung",
	"08:EC:A9": "Samsung",
	"0C:14:20": "Samsung",
	"0C:71:5D": "Samsung",
	"10:30:47": "Samsung",
	"14:49:E0": "Samsung",
	"18:3A:2D": "Samsung",
	"1C:62:B8": "Samsung",
	"20:64:32": "Samsung",
	"24:4B:81": "Samsung",
	"28:BA:B5": "Samsung",
	"2C:44:01": "Samsung",
	"30:07:4D": "Samsung",
	"34:2E:B6": "Samsung",
	"38:AA:3C": "Samsung",
	"3C:5A:B4": "Samsung",
	"40:0E:85": "Samsung",
	"44:5E:F3": "Samsung",
	"48:5A:3F": "Samsung",
	"4C:3C:16": "Samsung",
	"50:32:37": "Samsung",
	"54:88:0E": "Samsung",
	"58:21:EF": "Samsung",
	"5C:0A:5B": "Samsung",
	"60:6B:BD": "Samsung",
	"64:A7:69": "Samsung",
	"68:EB:C5": "Samsung",
	"6C:2F:2C": "Samsung",
	"70:F9:27": "Samsung",
	"74:45:8A": "Samsung",
	"78:1F:DB": "Samsung",
	"7C:61:66": "Samsung",
	"80:57:19": "Samsung",
	"84:A8:E4": "Samsung",
	"88:30:8A": "Samsung",
	"8C:3A:E3": "Samsung",
	"90:18:7C": "Samsung",
	"94:35:0A": "Samsung",
	"98:22:EF": "Samsung",
	"9C:02:98": "Samsung",
	"A0:0B:BA": "Samsung",
	"A4:EB:D3": "Samsung",
	"A8:DB:03": "Samsung",
	"AC:5F:3E": "Samsung",
	"B0:EC:71": "Samsung",
	"B4:62:93": "Samsung",
	"B8:5E:7B": "Samsung",
	"BC:79:AD": "Samsung",
	"C0:BD:D1": "Samsung",
	"C4:43:8F": "Samsung",
	"C8:BA:94": "Samsung",
	"CC:07:AB": "Samsung",
	"D0:22:BE": "Samsung",
	"D4:87:D8": "Samsung",
	"D8:90:E8": "Samsung",
	"DC:71:44": "Samsung",
	"E0:91:F5": "Samsung",
	"E4:40:E2": "Samsung",
	"E8:50:8B": "Samsung",
	"EC:1F:72": "Samsung",
	"F0:25:B7": "Samsung",
	"F4:0E:11": "Samsung",
	"F8:04:2E": "Samsung",
	"FC:A6:21": "Samsung",

	// Google
	"00:1A:11": "Google",
	"F4:F5:D8": "Google",
	"B4:F6:1C": "Google",
	"98:DE:D0": "Google",
	"64:16:66": "Google",
	"AC:37:43": "Google",

	// ASUS
	"00:E0:18": "ASUS",
	"00:13:D4": "ASUS",
	"00:15:F2": "ASUS",
	"00:17:31": "ASUS",
	"00:19:DB": "ASUS",
	"00:1D:60": "ASUS",
	"00:1F:C6": "ASUS",
	"00:22:15": "ASUS",
	"00:24:8C": "ASUS",
	"00:26:18": "ASUS",
	"04:92:26": "ASUS",
	"08:60:6E": "ASUS",
	"0C:9D:92": "ASUS",
	"10:7B:44": "ASUS",
	"14:DD:A9": "ASUS",
	"1C:87:2C": "ASUS",
	"20:CF:30": "ASUS",
	"24:4B:FE": "ASUS",
	"28:E3:47": "ASUS",
	"2C:56:DC": "ASUS",
	"30:5A:3A": "ASUS",
	"34:97:F6": "ASUS",
	"38:2C:4A": "ASUS",
	"3C:7C:3F": "ASUS",
	"40:16:7E": "ASUS",
	"44:85:00": "ASUS",
	"48:EE:0C": "ASUS",
	"4C:ED:FB": "ASUS",
	"50:46:5D": "ASUS",
	"54:04:A6": "ASUS",
	"58:11:22": "ASUS",
	"5C:33:8E": "ASUS",
	"60:45:CB": "ASUS",
	"64:51:7E": "ASUS",
	"6C:62:6D": "ASUS",
	"70:4D:7B": "ASUS",
	"74:D0:2B": "ASUS",
	"78:24:AF": "ASUS",
	"7C:10:C9": "ASUS",
	"80:1F:02": "ASUS",
	"84:A4:23": "ASUS",
	"88:D7:F6": "ASUS",
	"8C:10:D4": "ASUS",
	"90:2B:34": "ASUS",
	"94:DE:80": "ASUS",
	"98:5F:D3": "ASUS",
	"9C:5C:8E": "ASUS",
	"A0:63:91": "ASUS",
	"A4:2B:B0": "ASUS",
	"A8:5E:45": "ASUS",
	"AC:9E:17": "ASUS",
	"B0:6E:BF": "ASUS",
	"B4:2E:99": "ASUS",
	"B8:AE:ED": "ASUS",
	"BC:EE:7B": "ASUS",
	"C0:56:27": "ASUS",
	"C8:60:00": "ASUS",
	"CC:2D:E0": "ASUS",
	"D0:17:C2": "ASUS",
	"D4:5D:64": "ASUS",
	"D8:50:E6": "ASUS",
	"DC:39:6F": "ASUS",
	"E0:3F:49": "ASUS",
	"E4:70:B8": "ASUS",
	"E8:9A:8F": "ASUS",
	"EC:08:6B": "ASUS",
	"F0:79:59": "ASUS",
	"F4:6D:04": "ASUS",
	"F8:32:E4": "ASUS",
	"FC:34:97": "ASUS",

	// Netgear
	"00:09:5B": "Netgear",
	"00:0F:B5": "Netgear",
	"00:14:6C": "Netgear",
	"00:18:4D": "Netgear",
	"00:1B:2F": "Netgear",
	"00:1E:2A": "Netgear",
	"00:22:3F": "Netgear",
	"00:24:B2": "Netgear",
	"00:26:F2": "Netgear",
	"04:A1:51": "Netgear",
	"08:BD:43": "Netgear",
	"0C:80:63": "Netgear",
	"10:0D:7F": "Netgear",
	"14:59:C0": "Netgear",
	"20:4E:7F": "Netgear",
	"28:C6:8E": "Netgear",
	"2C:30:33": "Netgear",
	"30:46:9A": "Netgear",
	"34:08:04": "Netgear",
	"38:22:E2": "Netgear",
	"3C:37:86": "Netgear",
	"40:0D:10": "Netgear",
	"44:94:FC": "Netgear",
	"48:4B:AA": "Netgear",
	"4C:60:DE": "Netgear",
	"50:6A:03": "Netgear",
	"54:B8:0A": "Netgear",
	"58:98:35": "Netgear",
	"5C:D9:98": "Netgear",
	"60:38:E0": "Netgear",
	"64:0F:28": "Netgear",
	"6C:B0:CE": "Netgear",
	"70:4F:57": "Netgear",
	"74:44:01": "Netgear",
	"78:8A:20": "Netgear",
	"7C:03:AB": "Netgear",
	"80:3F:5D": "Netgear",
	"84:1B:5E": "Netgear",
	"88:AC:A6": "Netgear",
	"8C:3B:AD": "Netgear",
	"90:6E:BB": "Netgear",
	"94:44:52": "Netgear",
	"98:DA:C4": "Netgear",
	"9C:3D:CF": "Netgear",
	"A0:04:60": "Netgear",
	"A4:2B:8C": "Netgear",
	"A8:2B:B5": "Netgear",
	"AC:3C:0B": "Netgear",
	"B0:39:56": "Netgear",
	"B4:75:0E": "Netgear",
	"B8:38:61": "Netgear",
	"BC:AE:C5": "Netgear",
	"C0:3F:0E": "Netgear",
	"C8:D7:19": "Netgear",
	"CC:40:D0": "Netgear",
	"D0:14:11": "Netgear",
	"D4:AB:82": "Netgear",
	"D8:84:66": "Netgear",
	"DC:EF:09": "Netgear",
	"E0:46:9A": "Netgear",
	"E4:F4:C6": "Netgear",
	"E8:FC:AF": "Netgear",
	"EC:AD:E0": "Netgear",
	"F0:18:98": "Netgear",
	"F4:EC:38": "Netgear",
	"F8:8E:85": "Netgear",
	"FC:94:E3": "Netgear",
}

// LookupMACVendor returns the vendor name for a given MAC address
func LookupMACVendor(macAddr string) string {
	if macAddr == "" {
		return "Unknown"
	}

	// Normalize MAC address format
	macAddr = strings.ToUpper(macAddr)
	macAddr = strings.ReplaceAll(macAddr, "-", ":")

	// Extract OUI (first 3 octets)
	parts := strings.Split(macAddr, ":")
	if len(parts) < 3 {
		return "Invalid MAC"
	}

	oui := strings.Join(parts[:3], ":")

	if vendor, exists := macVendorDB[oui]; exists {
		return vendor
	}

	return "Unknown Vendor"
}

// IsLocallyAdministered checks if MAC address is locally administered
func IsLocallyAdministered(macAddr string) bool {
	if macAddr == "" {
		return false
	}

	parts := strings.Split(strings.ToUpper(macAddr), ":")
	if len(parts) < 1 {
		return false
	}

	// Check if second least significant bit of first octet is set
	firstOctet := parts[0]
	if len(firstOctet) >= 2 {
		switch firstOctet[1] {
		case '2', '3', '6', '7', 'A', 'B', 'E', 'F':
			return true
		}
	}

	return false
}
